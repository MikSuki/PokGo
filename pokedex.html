<html>

<head>
    <style>
        body {
            padding: 0;
            margin: 0;
        }

        canvas {
            position: absolute;
            top: 0;
        }
    </style>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
        integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <!-- <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
        integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
        crossorigin="anonymous"></script>
</head>

<body>
    <div class='pokemon_detail container text-center'>
        <p id='dex_number' class='pokemon_number'>003</p>
        <image id='dex_img' src='img/pokemon/006.png' width='250'></image>
        <p id='dex_name' class='pokemon_name'>噴火龍</p>
        <p class='pokemon_type_title'>屬性</p>
        <div id='dex_type' class='pokemon_type row '>
            <!-- <div class='col-2'>屬性</div> -->
            <div class='col'>火</div>
            <div class='col'>飛行</div>
        </div>
        <p class='pokemon_weakness_title'>弱點</p>
        <div id='dex_weakness' class='pokemon_weakness row'>
            <!-- <div class='col-2'>弱點</div> -->
            <div class='col'>水</div>
            <div class='col'>電</div>
            <div class='col'>岩石</div>
        </div>
        <div class='pokemon_HB row'>
            <div class="col-2"></div>
            <div class='pokemon_height_title col-2 text-right '>身高</div>
            <div id='dex_height' class='pokemon_height_value col text-left'>1.7 m</div>
            <div class='pokemon_height_title col-2 text-right'>體重</div>
            <div id='dex_weight' class='pokemon_weight_value col text-left'>90.5 kg</div>
            <div class="col-2"></div>
        </div>
        <div class='pokemon_story text-left'>
            <p id='dex_category' class='pokemon_category_title'>火焰寶可夢</p>
            <p id='dex_story' class='pokemon_story_body'>會在空中四處飛翔尋找強大的對手。在面對比自己弱小的對手時，牠不會吐出那可熔化一切的高溫火焰。</p>
        </div>
    </div>
    <script>
        const dex_ID = {
            number: '#dex_number',
            img: '#dex_img',
            name: '#dex_name',
            type: '#dex_type',
            weakness: '#dex_weakness',
            height: '#dex_height',
            weight: '#dex_weight',
            category: '#dex_category',
            story: '#dex_story',
        }

        const TYPE = [
            '一般', '火', '水', '電', '草', '冰', '格鬥', '毒', '地面'
            , '飛行', '超能力', '蟲', '岩石', '幽靈', '龍', '惡', '鋼', '妖精'
        ]

        const PATH = {
            pokemon: 'data/pokemon.json'
        }
        const max_pok_len = 386
        const POKEMONS = []
        const pok_img = []
        const img_src = {
            pookemon: "img/pokemon/",
        }
        let cnt = 0

        class Pokemon {
            constructor() {
                this.
                    this.name = ''
                this.type = []
            }
        }

        (async () => {
            await dataLoad(PATH.pokemon).then(text => data = JSON.parse(text));
            data.forEach(e => {
                POKEMONS.push(e)
            });

            function dataLoad(path) {
                return new Promise((resolve, reject) => {
                    const xhr = new XMLHttpRequest();
                    xhr.open("GET", path, true);
                    xhr.onload = () => resolve(xhr.responseText);
                    xhr.onerror = () => reject(xhr.statusText);
                    xhr.send();
                });
            }
        })();


        for (let i = 0; i < max_pok_len; ++i) {
            let fn = i + 1
            if (fn < 10) fn = '00' + fn
            else if (fn < 100) fn = '0' + fn
            pok_img[i] = document.createElement("img")
            pok_img[i].width = 50
            pok_img[i].setAttribute('draggable', false);
            document.body.appendChild(pok_img[i])
            pok_img[i].onload = function () {
                pok_img[i].onclick = function () {
                    setDexDetail(i + 1)
                }
                ++cnt
                if (cnt >= max_pok_len)
                    console.log('load over')
            }
            pok_img[i].src = img_src.pookemon + fn + ".png"
        }


        function setDexDetail(number) {
            const pokemon = POKEMONS[number - 1]
            const elem_type = $(dex_ID.type)
            const elem_weakness = $(dex_ID.weakness)
            $(dex_ID.number).html(pokemon.number)
            $(dex_ID.img).attr("src", img_src.pookemon + pokemon.number + '.png');
            $(dex_ID.name).html(pokemon.name)
            $(dex_ID.height).html(pokemon.height)
            $(dex_ID.weight).html(pokemon.weight)
            $(dex_ID.category).html(pokemon.category)
            $(dex_ID.story).html(pokemon.story)
            // type
            elem_type.empty()
            pokemon.types.forEach(i => {
                let div = document.createElement('div')
                div.classList.add('col')
                div.innerHTML = TYPE[i]
                elem_type.append(div)
            })
            // category
            elem_weakness.empty()
            pokemon.weaknesses.forEach(i => {
                let div = document.createElement('div')
                div.classList.add('col')
                div.innerHTML = TYPE[i]
                elem_weakness.append(div)
            })
        }


    </script>

</body>

</html>